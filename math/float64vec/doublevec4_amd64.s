TEXT ·dv4_AddAVX(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VADDPD Y1, Y0, Y2
	VMOVAPD Y2, 0(CX)
	RET

TEXT ·dv4_AddSSE2(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	ADDPD X2, X0
	ADDPD X3, X1
	MOVAPD X0, 0(CX)
	MOVAPD X1, 16(CX)
	RET

TEXT ·dv4_SubAVX(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VSUBPD Y1, Y0, Y2
	VMOVAPD Y2, 0(CX)
	RET

TEXT ·dv4_SubSSE2(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	SUBPD X2, X0
	SUBPD X3, X1
	MOVAPD X0, 0(CX)
	MOVAPD X1, 16(CX)
	RET

TEXT ·dv4_MulAVX(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VMULPD Y1, Y0, Y2
	VMOVAPD Y2, 0(CX)
	RET

TEXT ·dv4_MulSSE2(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	MULPD X2, X0
	MULPD X3, X1
	MOVAPD X0, 0(CX)
	MOVAPD X1, 16(CX)
	RET

TEXT ·dv4_MulAddFMA(SB), $0-32
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ c+16(FP), CX
	MOVQ result+24(FP), DX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VMOVAPD 0(CX), Y2
	VFMADD132PD Y0, Y1, Y2
	VMOVAPD Y2, 0(DX)
	RET

TEXT ·dv4_MulAddAVX(SB), $0-32
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ c+16(FP), CX
	MOVQ result+24(FP), DX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VMOVAPD 0(CX), Y2
	VMULPD Y1, Y0, Y3
	VADDPD Y3, Y2, Y4
	VMOVAPD Y4, 0(DX)
	RET

TEXT ·dv4_MulAddSSE2(SB), $0-32
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ b+16(FP), CX
	MOVQ result+24(FP), DX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	MOVAPD 0(CX), X4
	MOVAPD 16(CX), X5
	MULPD X2, X0
	MULPD X3, X1
	ADDPD X4, X0
	ADDPD X5, X1
	MOVAPD X0, 0(DX)
	MOVAPD X1, 16(DX)
	RET

TEXT ·dv4_DivAVX(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VDIVPD Y1, Y0, Y2
	VMOVAPD Y2, 0(CX)
	RET

TEXT ·dv4_DivSSE2(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	DIVPD X2, X0
	DIVPD X3, X1
	MOVAPD X0, 0(CX)
	MOVAPD X1, 16(CX)
	RET

TEXT ·dv4_MinAVX(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VMINPD Y0, Y1, Y2
	VMOVAPD Y2, 0(CX)
	RET

TEXT ·dv4_MinSSE2(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	MINPD X2, X0
	MINPD X3, X1
	MOVAPD X0, 0(CX)
	MOVAPD X1, 16(CX)
	RET

TEXT ·dv4_MaxAVX(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VMAXPD Y0, Y1, Y2
	VMOVAPD Y2, 0(CX)
	RET

TEXT ·dv4_MaxSSE2(SB), $0-24
	MOVQ a+0(FP), AX
	MOVQ b+8(FP), BX
	MOVQ result+16(FP), CX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	MAXPD X2, X0
	MAXPD X3, X1
	MOVAPD X0, 0(CX)
	MOVAPD X1, 16(CX)
	RET

TEXT ·dv4_ClampAVX(SB), $0-32
	MOVQ v+0(FP), AX
	MOVQ mn+8(FP), BX
	MOVQ mx+16(FP), CX
	MOVQ result+24(FP), DX
	VMOVAPD 0(AX), Y0
	VMOVAPD 0(BX), Y1
	VMOVAPD 0(CX), Y2
	VMAXPD Y0, Y1, Y3
	VMINPD Y2, Y3, Y4
	VMOVAPD Y4, 0(DX)
	RET

TEXT ·dv4_ClampSSE2(SB), $0-32
	MOVQ v+0(FP), AX
	MOVQ mn+8(FP), BX
	MOVQ mx+16(FP), CX
	MOVQ result+24(FP), DX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	MOVAPD 0(BX), X2
	MOVAPD 16(BX), X3
	MOVAPD 0(CX), X4
	MOVAPD 16(CX), X5
	MAXPD X2, X0
	MAXPD X3, X1
	MINPD X4, X0
	MINPD X5, X1
	MOVAPD X0, 0(DX)
	MOVAPD X1, 16(DX)
	RET

TEXT ·dv4_CeilAVX(SB), $0-16
	MOVQ v+0(FP), AX
	MOVQ result+8(FP), BX
	VMOVAPD 0(AX), Y0
	VROUNDPD $10, Y0, Y1
	VMOVAPD Y1, 0(BX)
	RET

TEXT ·dv4_CeilSSE41(SB), $0-24
	MOVQ v+0(FP), AX
	MOVQ result+8(FP), BX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	ROUNDPD $10, X0, X2
	ROUNDPD $10, X1, X3
	MOVAPD X2, 0(BX)
	MOVAPD X3, 16(BX)
	RET

TEXT ·dv4_RoundAVX(SB), $0-16
	MOVQ v+0(FP), AX
	MOVQ result+8(FP), BX
	VMOVAPD 0(AX), Y0
	VROUNDPD $00, Y0, Y1
	VMOVAPD Y1, 0(BX)
	RET

TEXT ·dv4_RoundSSE41(SB), $0-24
	MOVQ v+0(FP), AX
	MOVQ result+8(FP), BX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	ROUNDPD $00, X0, X2
	ROUNDPD $00, X1, X3
	MOVAPD X2, 0(BX)
	MOVAPD X3, 16(BX)
	RET

TEXT ·dv4_FloorAVX(SB), $0-16
	MOVQ v+0(FP), AX
	MOVQ result+8(FP), BX
	VMOVAPD 0(AX), Y0
	VROUNDPD $01, Y0, Y1
	VMOVAPD Y1, 0(BX)
	RET

TEXT ·dv4_FloorSSE41(SB), $0-24
	MOVQ v+0(FP), AX
	MOVQ result+8(FP), BX
	MOVAPD 0(AX), X0
	MOVAPD 16(AX), X1
	ROUNDPD $01, X0, X2
	ROUNDPD $01, X1, X3
	MOVAPD X2, 0(BX)
	MOVAPD X3, 16(BX)
	RET
